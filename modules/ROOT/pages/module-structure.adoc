= Структура модуля

[#components]
== Компоненты модуля

.Модуль состоит из следующих компонентов:
. Библиотека карточек _Обмен юридически значимыми документами_ с карточками:
.. _Справочник настроек операторов ЮЗДО_ -- карточка {dv}, в которой:
+
* Настраиваются параметры подключения к сервисам операторов ЭДО.
* Указываются программные компоненты с реализацией функций обмена информацией с операторами ЭДО через коннекторы к операторам ЭДО.
* Указываются данные организаций-участников ЭДО.
+
.. _Карточка обмена сообщениями_ -- карточка {dv} с данными документа, отправляемого оператору ЭДО, на основе которых формируются электронные сообщения для оператора.
.. _Карточка приглашения к обмену_ -- карточка {dv}
+
.. _Расширение навигатора ЮЗДО_ -- добавляет на ленту {wincl}а раздел _ЮЗДО_ с кнопками отправки и подписания неформализованных документов.
. Программные компоненты (библиотеки DLL):
.. Компонент чтения -- содержит функцию получения данных из карточек определенного типа/вида. +
Используется при создании _Карточек обмена сообщениями_.
+
.. Компонент изменения -- содержит функцию изменения данных в карточках определенного типа/вида. +
Используется при изменении документов, по которым поступили ответы от оператора ЭДО.
+
.. Компонент создания -- содержит функцию создания карточек определенного типа/вида. +
Используется при создании карточек в системе {dv} по документам, поступившим от оператора ЭДО.
+
.. Сервис сообщений -- содержит функции отправки и получения электронных сообщений оператору ЭДО.
.. Компонент импорта -- содержит функции получения конфигурации от оператора ЭДО: списка подразделений организации и связанных организаций, списка контрагентов и ящиков.
.. Компонент работы с подписями -- содержит функции подписания электронных сообщений и текстовых комментариев, отправляемых оператору ЭДО.

[#web-layouts]
== Web-разметки для видов карточек

. Исходящий УПД
.. Исходящий УПД (внутри)
.. Исходящий УПД (просмотр)
.. Исходящий УПД (создание)
.. Исходящий УКД (внутри)
.. Исходящий УКД (просмотр)
.. Исходящий УКД (создание)
.. Исходящее исправление УПД (внутри)
.. Исходящее исправление УПД (просмотр)
.. Исходящее исправление УПД (создание)
. Входящий УПД
.. Входящий УПД (просмотр)
.. Входящий УПД (создание)
.. Входящий УКД
. Приглашения ЭДО:
.. Входящее приглашение ЭДО
.. Исходящее приглашение ЭДО (отправлено)
.. Исходящее приглашение ЭДО (проект)
. Формализованный акт.

[#grid-plugin]
== Плагин для грида

В пакет инсталляции модуля входит плагин `EDIMessagesLog` для ЭУ `_Контрол табличных данных_`. Плагин преобразует элемент управления в _Журнал обмена ЮЗДО_ для {wc}. Подробнее про ЭУ см. в xref:5.5.17@webclient:layouts:ctrl/table/dataGridControl.adoc[документации модуля {wc}]".

[#inner-links]
== Сведения о связях между составными частями модуля

При выполнении в карточке _Документ_ действий, предусматривающих необходимость передачи документа оператору ЭДО, формируется _Карточка обмена сообщениями_. Данные, необходимые для создания _Карточки обмена сообщениями_, предоставляются компонентом чтения, который получает их из отправляемого документа. Для чтения каждого вида карточек может использоваться собственный компонент чтения.

БП Отправка сообщений ЮЗДО::
При появлении в системе новой _Карточки приглашения к обмену_ БП _Отправка сообщений ЮЗДО_ формирует исходящее сообщение электронного обмена для оператора ЭДО и передаёт его по каналу связи. При отправке сообщения используется реализация сервиса сообщений коннектора к данному оператору ЭДО (устанавливается отдельно).

БП Получение сообщений ЮЗДО::
БП _Получение сообщений ЮЗДО_ получает входящие сообщения от операторов ЭДО.
+
.Способ обработки входящих сообщений зависит от их содержимого:
* При получении электронного документа -- в {dv} создаётся карточка документа.
* При получении квитанции, подтверждающей получение оператором ЭДО отправленного формализованного документа -- изменяется статус исходной карточки документа, а пользователю предоставляется возможность отправить оператору ЭДО подтверждение о получении извещения.
* При получении ответа на отправленный неформализованный документ -- изменяется статус обмена.

БП Перенос файлов из сообщений ЮЗДО::
БП _Перенос файлов из сообщений ЮЗДО_ переносит полученные от контрагентов титулы покупателя в карточки УПД. БП также переносит изменения состояния документов.

БП Отправка приглашений ЮЗДО::
При появлении в системе новой _Карточки приглашения ЭДО_ БП _Получение приглашений ЮЗДО_ формирует входящее приглашение к обмену электронным документооборотом для оператора ЭДО. При отправке приглашений ЭДО используется БП _Отправка приглашений ЭДО_. Для получения и отправки приглашений к обмену ЭДО по каналу связи требуется наличие коннектора к оператору ЭДО (устанавливается отдельно).

БП Получение приглашений ЮЗДО::
При появлении в системе новой _Карточки обмена сообщениями_ БП _Получение приглашений ЮЗДО_ формирует исходящее сообщение электронного обмена для оператора ЭДО и передаёт его по каналу связи. При отправке сообщения используется реализация сервиса сообщений коннектора к данному оператору ЭДО (устанавливается отдельно).

[#outer-links]
== Сведения о связях с другими системами

_{em}_ является промежуточным звеном в связи системы {dv} с операторами ЭДО.

Модуль предоставляет публичные интерфейсы, которые используются системой {dv} для вызова функций коннекторов к операторам ЭДО. Коннекторы непосредственно подключаются к операторам ЭДО через каналы связи для передачи и получения электронных сообщений.

.Связь модуля с другими системами
image::admin:outer-links.png[Связь модуля с другими системами]

