= PowerOfAttorneyDataReader -- класс

Содержит методы для чтения машиночитаемой доверенности

* *Пространство имен:* `DocsVision.Edi.Runtime.BackOffice`
* *Сборка:* `DocsVision.Edi.Runtime.Backoffice.dll`

== Синтаксис

[source,csharp]
----
public class PowerOfAttorneyDataReader : DocumentDataReader
----

== Методы

[cols=",",options="header"]
|===
|Имя |Описание

|`PrepareMessageData(Guid)` a|Создаёт экземпляр электронного сообщения электронного обмена.

*Тип возвращаемого значения*: `xref:api/MessageData.adoc[MessageData]`.

.Параметры:
* `cardId` -- идентификатор карточки, для которой формируется сообщение электронного обмена для отправки оператору ЭДО.
* `documentType` -- тип документа.
* `documentVersion` -- версия документа.

В стандартной конфигурации модуля метод вызывается при отправке оператору ЭДО сообщения электронного обмена с новым документом.

|`ReadAdditionalAttributes(MessageData, Document)` a|Читает дополнительные атрибуты

.Параметры:
* `messageData` -- электронное сообщение, полученное от контрагента
* `document` -- документ

|`PrepareFileData(Guid, Guid, Guid, bool, string)` a|Создаёт экземпляр файла сообщения электронного обмена.

*Тип возвращаемого значения*: `xref:api/MessageFile.adoc[MessageFile]`.

.Параметры:
* `cardId` -- идентификатор карточки, содержащий файл.
* `fileId` -- идентификатор файла, передаваемого в сообщении.
* `signatureId` -- идентификатор подписи, которой подписан файл.
* `isMain` -- файл является основным.
* `tempFolder` -- временный каталог, для выгрузки файла.

В стандартной конфигурации модуля метод вызывается при отправке оператору ЭДО сообщения электронного обмена с новым документом.

В большинстве случаев полностью реализовывать данный метод не требуется, т.к. принцип подготовки файла электронного сообщения стандартный. Чтобы использовать стандартный механизм формирования, достаточно вернуть из метода значение `null`.

|`GetFileDigest(Guid, Guid)` a|Предоставляет описание (дайджест) файла карточки.

*Тип возвращаемого значения*: `System.String`.

.Параметры:
* `cardId` -- идентификатор карточки.
* `fileId` -- идентификатор файла, для которого возвращается описание.

В стандартной конфигурации модуля метод вызывается при открытии формы отправки электронного документа.

|`GetFileContent(Guid, Guid)` a|Предоставляет содержимое файла карточки.

*Тип возвращаемого значения*: `System.String`.

.Параметры:
* `cardId` -- идентификатор карточки.
* `fileId` -- идентификатор файла, для которого возвращается содержимое.

В стандартной конфигурации модуля метод вызывается при открытии формы отправки электронного документа.



|===
